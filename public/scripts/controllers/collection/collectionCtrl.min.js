/*! collection-application 2017-06-08 */

"use strict";angular.module("collectionApp").directive("fileModel",["$parse",function(t){return{restrict:"A",link:function(e,o,n){var i=t(n.fileModel).assign;o.bind("change",function(){e.$apply(function(){i(e,o[0].files[0])})})}}}]).controller("collectionCtrl",["$scope","$http","$location","User",function(t,e,o,n){t.templateUrl="views/pages/dashboard/collection/collectionList.html?v="+window.app_version,t.showgrid=function(){t.templateUrl="views/pages/dashboard/collection/collectionGrid.html?v="+window.app_version},t.showlist=function(){t.templateUrl="views/pages/dashboard/collection/collectionList.html?v="+window.app_version},t.collectionData=[];var i=function(){n.getPermission().then(function(o){var n=o.data.data.permission,i=o.data.data._id;"Admin"!=n?e.get("/collectionList/"+i).success(function(o){t.newData=o.data,t.totalcol=o.data.length,angular.forEach(t.newData,function(o,n){var i=t.newData[n]._id;e.get("/collectionItemList/"+i).success(function(e){t.itemData=e.data,t.itemslength=t.itemData.length,t.collectionData.push({_id:t.newData[n]._id,collection_name:t.newData[n].collection_name,create_date:t.newData[n].create_date,description:t.newData[n].description,length:t.itemslength})})})}):e.get("/collectionList").success(function(e){t.collectionData=e.data})})};i();!function(){n.getPermission().then(function(o){var n=o.data.data._id;e.get("/itemList/"+n).success(function(e){t.totalItem=e.data.length}),e.get("/publicItemList/"+n).success(function(e){t.publicItem=e.data.length}),e.get("/privateItemList/"+n).success(function(e){t.privateItem=e.data.length})})}(),t.deleteCollection=function(o){e.delete("/deleteCollection/"+o).success(function(e){alert("Collection delete successfully."),t.collectionData=[],i()})},t.viewCollection=function(t){o.path("/dashboard/collection/info/"+t)},t.viewItemsCollection=function(t){o.path("/dashboard/collection/items/"+t)}}]).controller("collectionCreateCtrl",["$scope","$state","$http","$location","User",function(t,e,o,n,i){t.collectionData={};!function(){i.getPermission().then(function(e){t.collectionData.user_id=e.data.data._id})}(),t.errorMsg=!1,t.successMsg=!1,t.insertCollection=function(){t.collectionData.collection_name?o.post("/insertCollection",t.collectionData).success(function(o){if(o.success){t.successMsg=o.message,alert("Collection save successfully");var i=o.data._id;n.path("/dashboard/collection/items/"+i),$timeout(function(){e.reload("dashboard")},1e3)}}):(t.errorMsg="Please Enter Collection Name",alert("invalid Entry"))},t.cancel=function(){n.path("/dashboard/collection/info/")}}]).controller("UDRCollectionCtrl",["$scope","$http","$stateParams","$location",function(t,e,o,n){t.infoCollection=function(t){n.path("/dashboard/collection/info/"+t)},t.editCollection=function(t){n.path("/dashboard/collection/info/"+t+"/edit")},t.viewCollection=function(t){n.path("/dashboard/collection/items/"+t)},t.collectionData={};!function(){e.get("/collectionDetail/"+o.id).success(function(e){t.collectionData=e.data,t.collectionData.create_date=new Date(t.collectionData.create_date)})}(),t.updateCollection=function(){e.put("/updateCollection/"+t.collectionData._id,t.collectionData).success(function(e){alert("Collection detail successfully updated"),n.path("/dashboard/collection/info/"+t.collectionData._id)})},t.cancel=function(t){n.path("/dashboard/collection/info/"+t)},t.editItem=function(t){n.path("/dashboard/item/info/"+t+"/edit")},t.deleteItem=function(t){e.delete("/deleteItem/"+t).success(function(t){alert("Item delete successfully."),i()})},t.itemData={};var i=function(){e.get("/collectionItemList/"+o.id).success(function(e){if(t.itemData=e.data,t.itemslength=t.itemData.length,t.itemslength)for(var o=0;o<=0;o++)t.opt_field=t.itemData[o].optional_field_name})};i(),t.viewItem=function(t){n.path("/dashboard/item/info/"+t)},t.createItem=function(){n.path("/dashboard/collection/items/"+o.id+"/createItem")}}]);